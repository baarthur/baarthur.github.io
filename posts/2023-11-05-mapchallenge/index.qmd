---
title: "30 day Map Challenge 2023"
description: "Code and ramblings"
author:
  - name: Arthur Bazolli Alvarenga
    url: https://baarthur.github.io/
    affiliation: PPGE/UFJF
    affiliation-url: https://www2.ufjf.br/poseconomia/ 
date: 2023-11-05
date-modified: last-modified
categories: [R, r-spatial, maps, ramblings] # self-defined categories
citation: 
  url: https://baarthur.github.io/posts/2023-11-05-mapchallenge/ 
#image: thumbnail.png
draft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!

execute: 
  echo: fenced
  
format:
  html:
     include-in-header:
        text: |
          <style>
          h1 {
          color: #fff;
          }
          </style>
---

```{r}
#| label: setup
#| include: false

library(tmap)
tmap_mode("view")
```



I have known the 30 day map challenge for two years now, but I was always too shy to join it. But the whole point is to have fun and learn something along the way, so here I am! I will update this post daily with my maps and the link to the code on my [github repo](https://github.com/baarthur/mapchallenge-2023/tree/main). I missed the first two days, so I'm starting from day 3.



## Day three: polygons

I spent some five hours making this, and I sadly lost my original code because I was stupid enought to not save the file. Accidents happen, so always save your files! Fortunately, I was at a loose end enough to recreate it. 

The inspiration for this came from this tweet from `@_palenrique`, where he compared Brazil's Federal District size to other huge metropolitan areas. 

{{< tweet _palenrique 1719392264860909951 >}}

The biggest challenge was how to get all metropolitan areas in the same scale. I had a notion that I should use `coord_sf()` in my `ggplot` to make them all in the same frame, but I just did not know how to get a bounding box with the same widths for the different regions. Then I had an idea: what if I calculate a buffer from the region's centroid to the bounding box limit and use this constant ratio to create a buffer & a bounding box for each city? 

![](day-3_suffering.png){width="700"}

Anyways, here it is!

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/3-polygons.qmd)

![](p-day3.png)

This version is actually a little better than the original one, which you can still find on [twitter](https://twitter.com/baarthur0/status/1720592766479069266).



## Day four: a bad map!

Whenever I think of a bad map, three things come to my mind: clumsy information, bad colors, and the amazing [@TerribleMaps](https://twitter.com/TerribleMaps) twitter page. Then I thought, what can be both totally useful and disturbing at the same time? The answer was on my face: I've always been fascinated by how my home state of Minas Gerais looks like a face with a big nose and booger coming out of it, so I manually created a list of cities for each feature and `ggplot`ed it. 

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/4-bad_map.qmd)

{{< tweet baarthur0 1720837569494053167 >}}

Later on, I found out that [gaga stans really liked it](https://twitter.com/MazettiMiguel/status/1720842936793841979). I had no idea they had an internal joke about her!



## Day five: an analog map

Okay, I'm assuming this means I use no digital thing to make this, am I right? Since a kid/pre-teen I have always loved to draw maps, especially during boring classes in school. So that's what I did, but this time using fountain pains! 

I tried it five times before my final version. I ended up starting by Minas Gerais... And it says a lot that Minas is bigger than Amazonas on my map! Perhaps we increase the things we have a better grasp. I'm so used to Minas and the Southeast that all I can say is sorry for my terrible borders. At least I got all states and capitals right...

{{< tweet baarthur0 1721305648858558571 >}}



## Day six: Asia

So an Asia map... What can i do that's still related to what I know? Also, I'm very tired. So I just looked for trade values for 1997 and 2022 to see how imports & exports evolved between time and between countries. The scale was a hell of a nightmare as always, but I think this looks quite okay!

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/6-asia.qmd)
* See me on [Twitter](https://twitter.com/baarthur0/status/1721691439371788357)

![](p-day6.png)



## Day seven: a navigation map

Being a transportation nerd, today's quest is my favorite! I had no doubt and took my animated map for the São Paulo rapid transit network, now with a few tweaks. 

To summarize what I did: I have a dataframe with the innauguration date for each line and station. Although being different geometries, lines and stations need to be in the same `data.frame` for this to work, so you need to compatibilize them beforehand. Then, all you need to do is use `gganimate` and to make all stations persist in time, add `shadow_mark()`. 

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/7-navigation.qmd)
* See me on [Twitter](https://twitter.com/baarthur0/status/1722023441564340477)

{{< video p-day7.mp4 >}}



## Day nine: hexagons

I gotta admit, I was in a slump for a few days. Day 8 was the day before my master's thesis qualification, so I was very overwhelmed finishing my presentation etc. And once you stop producing, it's hard to get back on track! Nonetheless, here I am. 

I love hexagon maps, especially the ones enabled by the great [Access to Opportunities Project](https://www.ipea.gov.br/acessooportunidades/en/) by Ipea... So this was a no-brainer for me: During my Spatial Econometrics course last year, we had to choose a theme and make all sort of spatial shenanigans with it---I'll post a tutorial on spatial analysis one day!

These maps are from my beloved home city, Belo Horizonte, capital of Minas Gerais. Home to 2.3 million inhabitants, it is at the heart of a 5.7 million inhabitant metropolis. It's a shame we only have data for the capital, because the surrounding cities work as an interconnected labor market with very differing realities, but we can still capture striking patterns in the capital.

First, we have a local index of spatial autocorrelation (LISA) for income, based in the 2010 census---can't wait to reproduce this with 2022 data, as soon as it gets released! The second is a bivariate index, comparing income and access to job opportunities.

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/9-hexagons.qmd)
* See me on [Twitter](https://twitter.com/baarthur0/status/1724473133413884395)

Besides the `ggplot`s, here I also used `tmap` for interactive viewing. I love these interactive maps, because they really allow you to see what's going on by navigating through regions.

### Univariate LISA for income

![](p-day9_1.png)

```{r}
#| echo: false

readRDS("data/tmap_lisa_bhz.RDS")
```


### BiLISA for income and access to job opportunities

![](p-day9_2.png)

```{r}
#| echo: false

readRDS("data/tmap_lisa_bi_bhz.RDS")
```



## Day 11: a retro map

I have always loved antique maps, especially the 19th century ones. Here are some of my favorites that served as inspiration for today's map:

:::: {layout-nrow=1 layout-valign="bottom"}

::: {layout-nrow=1}
![Original plan for Belo Horizonte, 1893.](day-11_bh.jpeg){width="300"}
![Central do Brasil Railway, 1890.](day-11_br1.png){width="300"}
:::

![Brazilian Railways Company, 1912.](day-11_br2.webp){width="800"}
::::

So basically this is what I had to do: 
- adjust theme elements, e.g. `plot.background`, `plot.title`, and `font`;
- use colors from an old map;
- find online fonts that are similar to old map typography, which I found `here`.

Since it is a retro map and not a historic one, this is the actual map of operating, under construction, and planned railways in Brazil, as of 2023. The railways shapefile was downloaded from [ANTT](https://www.gov.br/transportes/pt-br/assuntos/dados-de-transportes/bit/bit-mapas), the national ground transportation agency.

I was highly on doubt if I should paint the ocean or not, but I ended up liking this version.

* Fork me on [GitHub](https://github.com/baarthur/mapchallenge-2023/blob/main/src/11-retro.qmd)
* See me on [Twitter](https://twitter.com/baarthur0/status/1724944556603433344)

![](p-day11.png)

### Fun fact

While researching maps, I found [this interesting article](https://ge.globo.com/sp/sorocaba/futebol/campeonato-paulista/noticia/2015/01/paulistao-historias-de-cidades-e-times-do-interior-sao-ligadas-pela-ferrovia.html) (in portuguese) about how football (yes I refuse to say soccer) teams in São Paulo state relate to railway history 

